# Raspberry pi master node

베드솔루션 프로젝트의 마스터 노드에 해당하는 라즈베리파이 제어를 위한 프로그램입니다.
프로그램은 크게 아래 3계층으로 구성되어있습니다.

## 프로그램 구조
| 계층 번호 | 계층 이름  | 설명                           |
|----------|--------|------------------------------|
| 3        | 표현 계층  | 서비스 계층에서 처리된 결과를 화면상에 표시합니다. |
| 2        | 서비스 계층 | 통신으로 받은 데이터를 처리합니다.          |
| 1        | 통신 계층  | 서버 및 타 장치와 통신을 담당합니다.        |

## Master node 서비스
마스터 노드에 해당하는 라즈베리파이는 다음 기능을 수행합니다.

### <통신계층>
1. supabse서버에 환자의 부위별 압력 로그를 전송합니다. - (a)
2. 시리얼로부터 값을 가져와 이를 행렬형태로 변환합니다. - (b)
3. 컨트롤 노드에게 제어와 관련된 정보를 전송합니다. - (c)
4. supabase서버에서 환자 설정을 가져옵니다. - (d)
5. cloud messaging으로 푸시 알림을 전송합니다. - (e)

### <서비스계층>
1. (a)로부터 받은 값의 데이터를 이용하여 자세를 추론합니다. - (f)
2. (1)에서 추론된 자세를 이용하여 환자의 압력받는 부위를 판단합니다. - (g)
3. 캐시로 저장되어있는 로그를 바탕으로 현재 자세에서 각 부위별로 얼마만큼 압력이 유지되었는지 기록합니다. (a)를 이용하여 서버 로그를 업데이트합니다. - (h)
4. (2)에서 추론된 압력 받는 부위를 통해 제어신호를 (c)를 통해 전송합니다. - (i)
5. 주기적으로 (d)를 가져와 특정 임계값이 넘었을떄 (e)를 통해 알림 메시지를 전송합니다.

### <표현 계층>
1. (d), (e)의 결과를 표형식으로 출력합니다.
2. (g)에서 컨트롤노드에 전달된 제어신호를 표시합니다.
3. 환자 정보를 표시합니다.